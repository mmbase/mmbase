<mm:cloud 
    xmlns:di="http://www.didactor.nl/ditaglib_1.0"
    xmlns:mm="http://www.mmbase.org/mmbase-taglib-2.0"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:jsp="http://java.sun.com/JSP/Page"
    method="delegate" >
  <mm:content type="application/xml" expires="0">
    <jsp:output omit-xml-declaration="yes" />
    <jsp:directive.include file="/shared/setImports.jsp" />
    <div>
      <!-- Always include the progress component -->
      <div class="progress">
        <mm:treefile page="/progress/index.jsp" objectlist="$includePath" referids="$referids" write="false">
          <a href="${_}" class="menubar"> <di:translate key="progress.progress" /><di:hasrole role="student">: </di:hasrole></a>
        </mm:treefile>
        <!-- spacers are evil! -->
        <img src="${mm:treefile('/gfx/spacer.gif', pageContext,includePath)}" width="1" height="15" alt="" />
      </div>
      <di:hasrole role="student">
        <div class="progressMeter"  onclick="reloadProgress()">          
          <mm:import id="progress"><mm:treeinclude page="/progress/getprogress.jsp" objectlist="$includePath" referids="$referids" escape="trimmer" /></mm:import>     
          <c:if test="${progress ge 0.0}">
            <img src="${mm:treefile('/gfx/bar_left.gif', pageContext, includePath)}" width="4" height="13" alt="" />
            <img src="${mm:treefile('/gfx/bar_center.gif', pageContext, includePath)}" 
                 width="${progress * 92}" height="13" alt="" />
            <img src="${mm:treefile('/gfx/bar_right.gif', pageContext, includePath)}" width="4" height="13" alt="" />
          </c:if>

        </div>
      </di:hasrole>
    </div>
  </mm:content>
</mm:cloud>

