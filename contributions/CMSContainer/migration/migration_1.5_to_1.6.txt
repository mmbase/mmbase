Migration document:

Part: core
From version: 1.5
To version: 1.6


Execute the following steps below in the given order:

Name: Add publishdate, expiredate, use_expirydate and m_status column to urls, images and attachments
Goal: Add publishdate, expiredate, use_expirydate and m_status column to urls, images and attachments
Type:  sql-script
--- Start script ---
ALTER TABLE mm_attachments ADD column (publishdate datetime default NULL,expiredate datetime default NULL,use_expirydate bit(1) NOT NULL,m_status text);
ALTER TABLE mm_images ADD column (publishdate datetime default NULL,expiredate datetime default NULL,use_expirydate bit(1) NOT NULL,m_status text);
ALTER TABLE mm_urls ADD column (publishdate datetime default NULL,expiredate datetime default NULL,use_expirydate bit(1) NOT NULL,m_status text);

ALTER TABLE live_attachments ADD column (publishdate datetime default NULL,expiredate datetime default NULL,use_expirydate bit(1) NOT NULL,m_status text);
ALTER TABLE live_images ADD column (publishdate datetime default NULL,expiredate datetime default NULL,use_expirydate bit(1) NOT NULL,m_status text);
ALTER TABLE live_urls ADD column (publishdate datetime default NULL,expiredate datetime default NULL,use_expirydate bit(1) NOT NULL,m_status text);

--- End script ---
Exceptions/errors/other problems and what to do:
*
*
*

Name: Add nodetype column to workflowitem
Goal: Add nodetype column to workflowitem
Type:  sql-script
--- Start script ---
ALTER TABLE mm_workflowitem ADD column nodetype varchar(64) default NULL;

--- End script ---
Exceptions/errors/other problems and what to do:
*
*
*


Name: Add title and description column to urls / images
Goal: Asset improvements
Type:  sql-script
--- Start script ---
ALTER TABLE mm_urls ADD column title text;
ALTER TABLE mm_urls MODIFY description text;
ALTER TABLE mm_images MODIFY title text;

ALTER TABLE live_images MODIFY title text;
ALTER TABLE live_urls ADD column title text;
ALTER TABLE live_urls MODIFY description text;
--- End script ---
Exceptions/errors/other problems and what to do:
*
*
*


Name: Add workflowrel relation between workflowitem and assetelement to typerel
Goal: Add workflowrel relation between workflowitem and assetelement to typerel
Type:  sql-script
--- Start script ---
INSERT INTO mm_typerel SELECT 10001, 7, 'system', typedef1.number, typedef2.number, reldef.number, -1 FROM mm_typedef typedef1, mm_typedef typedef2, mm_reldef reldef WHERE typedef1.name='workflowitem' AND typedef2.name='assetelement' AND reldef.sname='workflowrel';

--- End script ---
Exceptions/errors/other problems and what to do:
*
*
*

Name: Add creationrel relation between assetelement and contentchannel to typerel
Goal: Add creationrel relation between assetelement and contentchannel to typerel
Type:  sql-script
--- Start script ---
INSERT INTO mm_typerel SELECT 10002, 7, 'system', typedef1.number, typedef2.number, reldef.number, -1 FROM mm_typedef typedef1, mm_typedef typedef2, mm_reldef reldef WHERE typedef1.name='assetelement' AND typedef2.name='contentchannel' AND reldef.sname='creationrel';

INSERT INTO live_typerel SELECT 10002, 7, 'system', typedef1.number, typedef2.number, reldef.number, -1 FROM live_typedef typedef1, live_typedef typedef2, live_reldef reldef WHERE typedef1.name='assetelement' AND typedef2.name='contentchannel' AND reldef.sname='creationrel';

--- End script ---
Exceptions/errors/other problems and what to do:
*
*
*

Name: Add deletionrel relation between assetelement and contentchannel to typerel
Goal: Add deletionrel relation between assetelement and contentchannel to typerel
Type:  sql-script
--- Start script ---
INSERT INTO mm_typerel SELECT 10003, 7, 'system', typedef1.number, typedef2.number, reldef.number, -1 FROM mm_typedef typedef1, mm_typedef typedef2, mm_reldef reldef WHERE typedef1.name='assetelement' AND typedef2.name='contentchannel' AND reldef.sname='deletionrel';

INSERT INTO live_typerel SELECT 10003, 7, 'system', typedef1.number, typedef2.number, reldef.number, -1 FROM live_typedef typedef1, live_typedef typedef2, live_reldef reldef WHERE typedef1.name='assetelement' AND typedef2.name='contentchannel' AND reldef.sname='deletionrel';

--- End script ---
Exceptions/errors/other problems and what to do:
*
*
*

Name: Add ownerrel relation between assetelement and user to typerel
Goal: Add ownerrel relation between assetelement and user to typerel
Type:  sql-script
--- Start script ---
INSERT INTO mm_typerel SELECT 10004, 7, 'system', typedef1.number, typedef2.number, reldef.number, -1 FROM mm_typedef typedef1, mm_typedef typedef2, mm_reldef reldef WHERE typedef1.name='assetelement' AND typedef2.name='user' AND reldef.sname='ownerrel';

INSERT INTO live_typerel SELECT 10004, 7, 'system', typedef1.number, typedef2.number, reldef.number, -1 FROM live_typedef typedef1, live_typedef typedef2, live_reldef reldef WHERE typedef1.name='assetelement' AND typedef2.name='user' AND reldef.sname='ownerrel';

--- End script ---
Exceptions/errors/other problems and what to do:
*
*
*