<?xml version="1.0"?>
<!DOCTYPE wizard-schema PUBLIC "-//MMBase/DTD editwizard 1.0//EN" "http://www.mmbase.org/dtd/wizard-schema_1_0.dtd"
[
   <!ENTITY extra_loads SYSTEM "extra_loads.xml">
   <!ENTITY extra_steps SYSTEM "extra_steps.xml">
   <!ENTITY extra_schemas SYSTEM "extra_schemas.xml">
   <!ENTITY extra_lists SYSTEM "extra_lists.xml">
]>
<wizard-schema id="empty">
  <title xml:lang="nl">Toets Editor</title>
  <title xml:lang="en">Test Editor</title>

  <action type="create">
    <object type="tests">
      <field name="showtitle">1</field>
      <field name="maychange">0</field>
      <field name="mayview">0</field>
      <field name="questionsperpage">0</field>
      <field name="feedbackpage">0</field>
      <field name="always_online">0</field>
      <field name="offline_date">2145928440</field>
    </object>
  </action>

  <action type="load">
    <relation destination="questions" role="posrel" />
    <relation destination="mmevents" role="related" />
    <relation destination="feedback" role="related" />
    &extra_loads;
  </action>

  <action type="delete" />

  <lists>
    <optionlist include="config/option_list/boolean.xml" />
    <optionlist include="config/option_list/boolean_inverse.xml" /> 
    <optionlist name="questionsperpage">
      <option id="0">Alle vragen op 1 pagina</option>
      <option id="1">1 vraag per pagina</option>
    </optionlist>
    <optionlist name="feedbackpage">
      <option id="0">geslaagd/gezakt</option>
      <option id="1">overzicht van antwoorden</option>
    </optionlist>
  </lists>

  <steps>
    <step form-schema="step1" />
    &extra_steps;
  </steps>

  <form-schema id="step1">
    <title xml:lang="nl">Toets invoeren</title>
    <title xml:lang="en">Enter test</title>

    <field name="name" >
      <prompt xml:lang="nl">Naam</prompt>
      <prompt xml:lang="en">Name</prompt>
    </field>

    <field name="showtitle" ftype="enum">
      <prompt xml:lang="nl">Titel laten zien</prompt>
      <prompt xml:lang="en">Show title</prompt>
      <optionlist select="boolean" />
    </field>

    <field name="text" ftype="html" dtminlength="0">
      <prompt xml:lang="nl">Tekst</prompt>
      <prompt xml:lang="en">Text</prompt>
    </field>

    <field name="questionamount">
      <prompt xml:lang="nl">Aantal te stellen vragen (&lt; 1: alle)</prompt>
      <prompt xml:lang="en">Number of questions to ask (&lt; 1: all)</prompt>
    </field>

    <field name="requiredscore">
      <prompt xml:lang="nl">Benodigd aantal goed</prompt>
      <prompt xml:lang="en">Required score</prompt>
    </field>

    <field name="maychange" ftype="enum">
      <prompt xml:lang="nl">Mag de student deze toets opnieuw maken?</prompt>
      <prompt xml:lang="en">May the student re-take the test?</prompt>
      <optionlist select="boolean_inverse" />
    </field>

    <field name="mayview" ftype="enum">
      <prompt xml:lang="nl">Mag de student deze toets bekijken na het maken?</prompt>
      <prompt xml:lang="en">May the student view the answers he gave after making the test?</prompt>
      <optionlist select="boolean_inverse" />
    </field>

    <field name="questionsperpage" ftype="enum">
      <prompt xml:lang="nl">Aantal vragen per pagina</prompt>
      <prompt xml:lang="en">Amount of questions on a page</prompt>
      <optionlist select="questionsperpage" />
    </field>

    <field name="feedbackpage" ftype="enum">
      <prompt xml:lang="nl">Feedback na het maken van de toets</prompt>
      <prompt xml:lang="en">Feedback after making the test</prompt>
      <optionlist select="feedbackpage" />
    </field>

    <field name="always_online" ftype="enum">
      <prompt xml:lang="nl">Altijd online</prompt>
      <prompt xml:lang="en">Always online</prompt>
      <optionlist select="boolean_inverse" />
    </field>
    
    <field name="online_date" ftype="date">
      <prompt xml:lang="nl">Online Tijden</prompt>   
      <prompt xml:lang="en">Online Time</prompt>   
    </field>  
        
    <field name="offline_date" ftype="date">
      <prompt xml:lang="nl">Offline Tijden</prompt>        
      <prompt xml:lang="en">Offline Time</prompt>        
    </field>    
        
    <list minoccurs="0" maxoccurs="*" ordertype="number" orderby="field[@name='pos']" role="posrel" destination="questions">
      <title xml:lang="nl">Bijbehorende vragen</title>
      <title xml:lang="en">Related questions</title>
      <item>
        <field name="title" ftype="data">
          <prompt xml:lang="nl">Titel</prompt>
          <prompt xml:lang="en">Title</prompt>
          <description xml:lang="nl">Titel van de vraag</description>
          <description xml:lang="en">Title of the question</description>
        </field>
        <field fdatapath="field[@name=&apos;pos&apos;]" ftype="line">
          <prompt xml:lang="nl">Positie</prompt>
          <prompt xml:lang="en">Position</prompt>
        </field>
      </item>

      <action type="create">
        <relation role="posrel" destinationtype="questions">
          <field name="pos">{sum(//relation[@role='posrel' and @lastitem='true']/field[@name='pos'])+{$pos}}</field>
        </relation>
      </action>

      <command name="search" nodepath="questions" fields="title" age="-1" orderby="number" directions="down" >
        <prompt xml:lang="nl">Zoeken naar vragen</prompt>
        <prompt xml:lang="en">Search questions</prompt>
        <search-filter>
          <name xml:lang="nl">Titel bevat</name>
          <name xml:lang="en">Title contains</name>
          <search-fields>title</search-fields>
        </search-filter>
      </command>

      <command name="startwizard" inline="true" wizardname="config/question/mcquestions" objectnumber="new">
        <prompt xml:lang="nl">Nieuwe Multiple Choice vraag</prompt>
        <prompt xml:lang="en">New Multiple Choice question</prompt>
      </command>

      <command name="startwizard" inline="true" wizardname="config/question/openquestions" objectnumber="new">
        <prompt xml:lang="nl">Nieuwe Open vraag</prompt>
        <prompt xml:lang="en">New Open question</prompt>
      </command>

      <command name="startwizard" inline="true" wizardname="config/question/rankingquestions" objectnumber="new">
        <prompt xml:lang="nl">Nieuwe Rangorde vraag</prompt>
        <prompt xml:lang="en">New Ranking question</prompt>
      </command>

      <command name="startwizard" inline="true" wizardname="config/question/valuequestions" objectnumber="new">
        <prompt xml:lang="nl">Nieuwe Waarde vraag</prompt>
        <prompt xml:lang="en">New Value question</prompt>
      </command>

      <command name="startwizard" inline="true" wizardname="config/question/couplingquestions" objectnumber="new">
        <prompt xml:lang="nl">Nieuwe Koppel vraag</prompt>
        <prompt xml:lang="en">New Coupling question</prompt>
      </command>

      <command name="startwizard" inline="true" wizardname="config/question/hotspotquestions" objectnumber="new">
        <prompt xml:lang="nl">Nieuwe Hotspot vraag</prompt>
        <prompt xml:lang="en">New Hotspot question</prompt>
      </command>

      <command name="startwizard" inline="true" wizardname="config/question/dropquestions" objectnumber="new">
        <prompt xml:lang="nl">Nieuwe drag en drop vraag</prompt>
        <prompt xml:lang="en">New drag and drop question</prompt>
      </command>

     <command name="startwizard" inline="true" wizardname="config/question/fillquestions" objectnumber="new">
        <prompt>Fill in the gaps</prompt>
    </command>
    
     <command name="startwizard" inline="true" wizardname="config/question/fillselectquestions" objectnumber="new">
        <prompt>Select in the gaps</prompt>
    </command> 
     <command name="startwizard" inline="true" wizardname="config/question/opennumeralquestions" objectnumber="new">
        <prompt xml:lang="en">Open numeral question</prompt>
        <prompt xml:lang="nl">Niuewe open cijfer vraag</prompt>
    </command>  
    <command name="startwizard" inline="true" wizardname="config/question/essayquestions" objectnumber="new">
        <prompt>Essay question</prompt>
    </command> 

    </list>
    &extra_lists;

    <list role="related" extends="config/online/online-list.xml" />
    <list destination="feedback" role="related" extends="config/feedback/feedback-list.xml" />
  </form-schema>

  &extra_schemas;

</wizard-schema>
