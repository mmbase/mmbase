<html
    xmlns="http://www.w3.org/1999/xhtml"
    xml:lang="en"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions"
    xmlns:mm-sr="http://www.mmbase.org/tags/mm/searchrelate"
    xmlns:jsp="http://java.sun.com/JSP/Page"
    xmlns:mm="http://www.mmbase.org/mmbase-taglib-2.0">
  <mm:content
      type="application/xhtml+xml"
      expires="0"
      language="en">
    <!--
        xmlns:mm-sr="urn:jsptagdir:/WEB-INF/tags/mm/searchrelate"

    -->
    <mm:cloud rank="administrator">

      <head>
        <jsp:directive.include file="/mmbase/validation/javascript.jspxf" />
      </head>
      <body>
        <h1>Search and Relate examples/tests</h1>

        <script type="text/javascript" src="test.js" />
        <mm:form id="testform123"
                 name="testform123"
                 >

          <mm:import externid="cancel" />
          <mm:present referid="cancel">
            <mm:cancel />
            <p>Canceled</p>
            <mm:refresh />
          </mm:present>


          <mm:node number="default.mags">
            <h2>1</h2>
            <h3><mm:field name="title" /></h3>

            <mm-sr:relatednodes type="news" role="posrel"
                                item="/item.jspx" />

          </mm:node>

          <input type="submit" name="submit" value="submit" />
          <mm:link>
            <mm:param name="cancel"></mm:param>
            <a href="${_}">cancel</a>
          </mm:link>
          <jsp:text> | </jsp:text>
          <mm:link>
            <a href="${_}">reload</a>
          </mm:link>
          <jsp:text> | </jsp:text>
          <mm:link page=".">
            <a href="${_}">back</a>
          </mm:link>


          <mm:import externid="submit" />
          <mm:valid>
            <p>Valid</p>
            <mm:present referid="submit">
              <mm:commit />
              <p>Committed</p>
              <mm:refresh />
            </mm:present>
          </mm:valid>



          <c:set value="${requestScope['org.mmbase.transaction'].nodes}" var="tn"  />
          <p>Number of nodes in transaction: ${fn:length(tn)}</p>
          <mm:listnodes referid="tn" commitonclose="false">
            <p><mm:index /> RN:${_node.number} TN:${_node._number}</p>
          </mm:listnodes>

        </mm:form>

      </body>
    </mm:cloud>

  </mm:content>
</html>
