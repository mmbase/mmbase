Migratie issues

2005-03-11

An extra field "showtitle" is added for a number of builders. The metadata builder has changed (field value is changed from virtual to persistent). 

ALTER TABLE mmb_educations ADD showtitle TINYINT(1);
ALTER TABLE mmb_pages ADD showtitle TINYINT(1);
ALTER TABLE mmb_learnblocks ADD showtitle TINYINT(1);
ALTER TABLE mmb_metadata ADD value BLOB;

To update the "value" field in already existing metadata, run:

/migrate-2005-03-11.jsp

After running this script: check log if there are metadata objects, which are not related to a metadatadefinition.
These metadata objects should be fixed or deleted.

2005-03-08

The people builder has been extended, therefore we now need to update the
database:

    ALTER TABLE mmb_people ADD remarks TEXT;
    ALTER TABLE mmb_contacts ADD remarks TEXT;

The portfolio folders have changed. Run

    /migrate-2005-03-08.jsp


2005-02-13

For the metadata editors the builder metadefinition has been extended with two additional
fields. For the metadata and the metadata editors to run correctly the following changes
should be carried out on the didactor databases.

ALTER TABLE mmb_metadefinition ADD minvalues INT;
ALTER TABLE mmb_metadefinition ADD required INT(1);

2004-02-10
 ** Interne opmerking **
 De build targets zijn iets aangepast, en een aantal config opties toegevoegd:

 aangepaste targets:

   webapp (was: "war") - maakt een cleane build/webapp en doet ook copy_builders
   war (was: "build.war") bouwt nu ook de war - depends: webapp

   dit betekend dat normaal gesproken je

    ant -propertyfile .... webapp
    kan doen voor een cleane build

    ant -propertyfile .... [build]
    voor tussentijdse build (let op! deze doet geen copy_builders, dus de 1e keer
    kun je het webste "webapp" gebruiken!)

    en voor een cleane war:
    ant -propertyfile .... war
    (was eerst "ant -propertyfile .... war copy_builders build.war")

 extra configure properties:

   war.name - naam van de war zonder .war extentie (default: didactor)
   providers - comma seperated list van alle provider template directories
               de meegenomen moeten worden in de webapp (default: leeg;
               dwz geen extra templates)

 extra propertyfiles: 
 
    er zijn een aantal extra propertyfiles toegevoegd zodat het
    makkelijker is om wars voor asp4all te maken:

    configure.properties.asp4all    - demo server (leeg)
    configure.properties.telecoach  - telecoach
    configure.properties.baronie    - baronie college
    configure.properties.bouwradius - bouwradius & bam
    configure.properties.zeeland    - roc's excl. baronie
    
    zie script makeallwars.sh voor extra shortcut


2005-01-26

 alter table mmb_attachments modify column title varchar(255);
 alter table mmb_people modify column email varchar(255);
 alter table mmb_contacts modify column email varchar(255);
 alter table mmb_images modify column description blob; 


2004-12-01

De portfolio component is verder uitgebreid en af gemaakt. Gebruikers hebben nu
de mogelijkheid om een beschrijving van zichzelf te geven. Hiervoor moet een
desription veld aan de people tabel worden toegevoegd. Verder worden er nu
standaard per gebruiker 3 typen portfolio's aangemaakt.

- Stop de applicatie en draai de volgende SQL statements:

    alter table mmb_people add column description blob;
    alter table mmb_contacts add column description blob;

- Start de applicatie met de nieuwe war file zodat de Portfolio applicatie
  gedeployed wordt.
- Herstart de applicatie zodat de wijzigingen van de Portfolio applicatie actief
  worden.
- Vraag de volgende jsp op (meerder keren draaien geeft geen problemen):

    migratie-2004-12-01.jsp


2004-11-26

  bugfix: het was mogelijk om meerdere people objecten aan te maken met dezelfde
  username. op dat moment kan je niet meer inloggen met die username. dit is nu
  opgelost.

  Cleanup code:
  
  de volgende code verwijderd de nieuwste "dubbele" usernames als er meer dan 1 is.
  bij deze accounts moeten dan nieuwe usernames aangemaakt worden:

    update mmb_people join mmb_people as mmb_people2 on mmb_people2.username =
    mmb_people.username set mmb_people.username="" where mmb_people.username != "" 
    and mmb_people2.number < mmb_people.number;

  Dit is NIET op te lossen dmv van de editors: de people builder verbiedt het
  aanpassen van eenmaal aangemaakte usernames.


2004-11-26

in de web.xml moet voor sites die de PDF functionaliteit gebruiken de parameter
internalUrl gezet worden:

   <!-- 
        please set this to the interal url of the web application
        if that is different from the "outside" url.

        it needs to be the full url including the application path
        i.e.

        if the application startpage is http://localhost:8080/didactor/index.jsp

        this url should be http://localhost:8080/didactor

        this url is used by the application to do HTTP requests
        to itself.
    -->
    <context-param>
        <param-name>internalUrl</param-name>
        <param-value>http://localhost:8080/didactor</param-value>
    </context-param>

Op dit moment hoeft dat alleen voor baronie college.


2004-11-11

Inlogtijden kloppen niet. De berekening is oplost, maar de tijden moeten gereset worden:
stop de applicatie en draai de volgende SQL:

    update mmb_classrel set onlinetime=0;


2004-11-03

De directory education/files in de root van de web applicatie is nu bestemd voor uploads. 
Deze moet dus niet geleegd worden bij deployment van een nieuwe war en moet schrijfbaar 
zijn voor de web applicatie.

 ** 
 
    2004-11-10 Dit is nu aanpasbaar via de web.xml:
    
    <param-name>filemanagementBaseUrl</param-name>
    
    geeft de url van de upload directory (zodat de bestanden weer te downloaden zijn)

    <param-name>filemanagementBaseDirectory</param-name>
    
    geeft het directory pad waar de bestanden naartoe worden ge-upload.
    deze moet schrijfbaar zijn voor de web applicatie en niet worden geleegd tijdens
    updates.


    Voor developers: deze waardes worden overgenomen uit de configure.properties
    filemanagement.data.directory en filemanagement.data.url
    als je een eigen propertyfile hebt moet je ant altijd aanroepen met
    ant -propertyfile propertyfilenaam - de web.xml wordt altijd opniew
    aangemaakt.

    voorbeeld van configure.properies setting:

    filemanagement.data.directory=/home/joost/lib/tomcat/webapps/didactor/education/files
    filemanagement.data.url=/education/files
    
 ** 

Er is een maximum upload van 50 Mb in de upload pagina. Waarschijnlijk moet ook de
configuratie van de webserver aangepast worden om dat soort grote uploads toe te staan.



Bovenstaande is de verantwoordelijkheid van de hosting provider.

File-uploads zijn bereikbaar voor gebruikers met toegang tot de content-management en
de nieuwe rol "filemanager". Deze rol moet dus aangemaakt worden.



2004-11-01

Pagina model is veranderd

alter table mmb_pages add column layout INT(11);
alter table mmb_pages add column imagelayout INT(11);

Daarna kan je /migrate-2002-11-03.jsp aanroepen om bestaande pagina's te migreren


2004-10-26

Kalender objectmodel is veranderd.


2004-10-13

* Er is een description veld toegevoegd aan metadefinition. Met het volgende commando wordt het toegevoegd aan bestaande mysql databases.

  ALTER TABLE mmb_metadefinition ADD description blob NOT NULL AFTER name;


* KEY op username in people & contacts tabellen is vervallen. de volgende SQL statements lossen dit op voor bestaande mysql databases.

  ALTER TABLE mmb_people DROP INDEX username;
  ALTER TABLE mmb_contacts DROP INDEX username;

2004-10-??

 chatchannels mogen geen spaties meer in veld 'name' hebben, (nieuwe worden automatisch aangemaakt) dit is voor bestaande chatchannels op te lossen via de mmeditors of direct in de database.

