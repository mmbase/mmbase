NatMM - install.txt
Version: 06.05.18
Author: H. Hangyi

To install NatMM:
1. download and install MMBase 1.7.4 (see server.xml for example configuration of Tomcat)
2. clean the WEB-INF/config/applications folder
3. create a NatMM build
4. copy the files of NatMM build over the MMBase 1.7.4 webapp
4.a. change settings in WEB-INF/config/modules/jdbc.xml
4.b. change settings in WEB-INF/config/log/log4j.xml
4.c. copy the builders from WEB-INF/config/applications/LeoCMS/builders/ to  WEB-INF/config/builders/
4.d. change settings in WEB-INF/config/builders/images.xml (and style.xml, when using nmintra)
4.e. make sure to load the LeoCMS. You can do this by change the setting for auto-deploy in the
     application file to true or by using the admin console (/mmbase/admin) to load the application. 
     The auto-deploy of LeoCMS is set to false to make sure that the demo-data from the LeoCMS application
     is not loaded into already existing databases containing the LeoCMS object model.
4.d. install one of the applications on top of LeoCMS. For this copy all builders you need for
     installing this application to WEB-INF/config/builders/
     E.g. if you want to use the templates in nmintra: 
     copy the builders from WEB-INF/config/applications/NMIntra/builders/ to  WEB-INF/config/builders/

IMPORTANT NOTE: The NatMM depends on 
a. an admin user with the alias users.admin and
b. a rubriek node with alias root, this rubriek is the root of your tree of websites.

These nodes are installed if you use the demo data files in the config/applications/LeoCMS directory. If you
do not use these demo data files, you can create the admin user manually after installation by:
1. change the setting for "security active" from true to false
2. restart Tomcat
3. add the alias users.admin to the admin user
4. changing the setting for "security active" from false to true

After installation the editors of LeoCMS can be found at:

http://localhost:8080/<your_webapp>/editors

When clicking "Pagina-editor" you will get the website tree, which is the main entrance for editors to edit the content.
Have a look at the user-manual /templates/doc/GebruikershandleidingEditors.doc (in Dutch unfortunately) to get an idea on how to work with the editors.

Note the link "Naar archiefkast" at the top of the left column in the "Pagina-editor", this links brings
the user to the special purpose editors selected for him. See the config/applications/NatMM/editwizards.xml file
for a full list of possible editors in LeoCMS.

CREATING AN ADDITIONAL INDEX FOR THE ARCHIVE

All indexes on key fields are created by MMBase automatically. For the archive object an index on the original_node field should be added to guarantee
good performs when searching for stored versions of nodes. In MySQL the query for this is:

ALTER TABLE v1_archief ADD INDEX original_node (number);

IMPORTANT NOTE: The NatMM makes use of OSCache for caching.
Items cached are:
1. the templates, you can use /editors/paginamanagement/flushlink.jsp to provide preview and publish functionality
2. the website tree, you see when click "Pagina-editor"
3. the converted urls (see nl.leocms.servlets.UrlCache)
There is a special editor you can use to flush all pages. It is /editors/util/flush_cache.jsp. So when you
expect something to change and it doesn't: use this page to make sure the entire cache is flushed.
