<?xml version="1.0"?>
<!DOCTYPE wizard-schema PUBLIC "-//MMBase/DTD editwizard 1.0//EN" "http://www.mmbase.org/dtd/wizard-schema_1_0.dtd">
<wizard-schema id="empty">
    <title>Multiple Choice Editor</title>

    <action type="create">
       <object type="mcquestions">
          <field name="showtitle">1</field>
          <field name="layout">0</field>
          <field name="type">0</field>
       </object>
    </action>



    <action type="load">
        <relation destination="mcanswers" role="posrel" />
        <relation destination="images" role="related" />
        <relation destination="feedback" role="related" />
        <relation destination="competencies" role="needcomp" />
        <relation destination="competencies" role="developcomp" />
    </action>

    <action type="delete" />


    <lists>
        <optionlist include="config/option_list/boolean.xml" />
        <optionlist name="mctypes">
            <option id="0">Een van de gegeven antwoorden kan worden geselecteerd</option>
            <option id="1">Meerdere antwoorden kunnen worden geselecteerd</option>
            <option id="2">Een waarde-antwoord kan worden geselecteerd</option>
        </optionlist>
        <optionlist name="layout">
            <option id="0">Alle antwoorden onder elkaar (geschud)</option>
            <option id="1">Alle antwoorden naast elkaar (geschud)</option>
            <option id="2">Pulldown menu (geschud)</option>
            <option id="3">Alle antwoorden onder elkaar (vaste volgorde)</option>
            <option id="4">Alle antwoorden naast elkaar (vaste volgorde)</option>
            <option id="5">Pulldown menu (vaste volgorde)</option>
        </optionlist>
        <optionlist include="config/option_list/boolean_inverse.xml" />
    </lists>

    <steps>
        <step form-schema="step1" />
        <step form-schema="step2" />
    </steps>

    <form-schema id="step1">
        <title>Multiple Choice vraag invoeren</title>
        <field name="title" >
            <prompt>Titel</prompt>
        </field>
        <field name="showtitle" ftype="enum">
           <prompt xml:lang="nl">Titel laten zien</prompt>
           <prompt xml:lang="en">Show title</prompt>
           <optionlist select="boolean" />
        </field> 
        <field name="text" ftype="html" dtminlength="0">
            <prompt>Tekst</prompt>
        </field>
        <field name="type" ftype="enum">
            <prompt>Type</prompt>
            <optionlist select="mctypes" />
        </field>
        <field name="layout" ftype="enum">
            <prompt>Layout</prompt>
            <optionlist select="layout" />
        </field>

        <list minoccurs="0" maxoccurs="*" ordertype="number" orderby="field[@name='pos']" role="posrel" destination="mcanswers">
            <title>Bijbehorende Multiple-Choice antwoorden</title>
            <item>
                <field name="text" ftype="line">
                    <prompt>Tekst</prompt>
                    <description>De antwoord tekst</description>
                </field>
                <field fdatapath="field[@name=&apos;pos&apos;]" ftype="line"><prompt>Positie</prompt></field>
                <field name="correct" ftype="enum">
                    <prompt>Correct</prompt>
                    <optionlist select="boolean_inverse" />
                </field>
                <field wizardname="config/answer/mcanswers" ftype="startwizard"/>
            </item>

            <action type="create">
                <relation role="posrel" destinationtype="mcanswers">
                  <field name="pos">{sum(//relation[@role='posrel' and @lastitem='true']/field[@name='pos'])+{$pos}}</field>
                </relation>
            </action>


<!--            <action type="add">
                <relation role="posrel" destinationtype="mcanswers">
                  <field name="pos">{sum(//relation[@role='posrel' and @lastitem='true']/field[@name='pos'])+{$pos}}</field>
                    <!-<object type="mcanswers">
                        <field name="text" />
                    </object>->
                </relation>
            </action>-->

            <command name="search" nodepath="mcanswers" fields="text" age="-1" orderby="number" directions="down">
                <prompt>Zoeken naar Antwoorden</prompt>
                <search-filter>
                    <name>Tekst bevat</name>
                    <search-fields>text</search-fields>
                </search-filter>
            </command>


            <command name="startwizard" inline="true" wizardname="config/answer/mcanswers" objectnumber="new">
                <prompt>Nieuwe Multiple Choice antwoord</prompt>
            </command>

        </list>
        <list role="related" extends="config/feedback/feedback-list.xml" />
    </form-schema>
    <form-schema id="step2">
        <title>Competenties invoeren</title>
        <field name="name" ftype="data"/>
        <list extends="config/competency/needcompetencies.xml"/>
        <list extends="config/competency/developcompetencies.xml"/>
    </form-schema>


</wizard-schema>
