<?xml version="1.0" encoding="UTF-8" ?>
<!-- 

   @author  Michiel Meeuwissen
   @version $Id: log4j.xml,v 1.1 2004-11-01 12:52:41 jdiepenmaat Exp $
   @since   MMBase-1.4

   Location of the log4j.dtd. 
   In Tomcat a simple "log4j.dtd" will do, but this does not work in
   older versions of Orion (because of limitation of Xerces). 
   You can give the full path to the dtd in the jar, like:
   SYSTEM "jar:file:/bigdisk/dev/lib/test/log4j.jar!/org/apache/log4j/xml/log4j.dtd"
   or somewhere on the web:
   SYSTEM "http://web.omroep.nl/mmbase/logging/log4j.dtd"
   
   It seems to work better in Orion if you put the log4j.dtd in
   WEB-INF/classes/org/apache/log4j/xml/log4j.dtd
   
-->
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd"
   [
    <!ENTITY mmlevel    "org.mmbase.util.logging.log4j.Log4jLevel" >
    <!ENTITY logdir   "${mmbase.logdir}" >
]>

<!-- 
  MMBase logging configuration 

  MMBase can use log4j for logging. See
  http://jakarta.apache.org. This is a sample configuration file for
  it. The name of this file is indicated in <CONFIGDIR>/log/log.xml

  Quick introduction on how to configure log4j.

  In the configuration you find two kind of things: Appenders, and
  Loggers. 

  The Appenders are describing the logfiles. There is only one defined
  in this file. It is not optimized for speed now, it is better use another
  Pattern layout in a speed critical situation.

  There is one special 'Logger', namely 'root'. Other loggers
  inherit from this one, but can override for example the level. 

  Currently the loggers are simply the complete MMBase class-names,
  with only one exception, namely 'STDERR'.

-->

<log4j:configuration 
  debug="false" 
  xmlns:log4j="http://jakarta.apache.org/log4j/"
  >

  <!-- 
  The appenders of the default log4j configuration are writing to 
  STDOUT on default. 
  This is problably not what you want, but at least it works always.
  (This also means that the &logdir; entity is not used in this example configuration)
  See in the eother examples how to configure a log file.
  -->

  <appender name="logfile" class="org.apache.log4j.FileAppender" >
    <param name="File" value="&logdir;mmlog4j.log" />
    <param name="Append" value="true" />
    <layout class="org.apache.log4j.PatternLayout">
      <!-- Default mmbase-layout 
         <param name="ConversionPattern" value="%d{ABSOLUTE} %-7p %c{4} - %m%n" />
      -->
      <!-- Layout containing classes etc ... 
		(very slow, don't use in production environment) 
	 <param name="ConversionPattern" value="%d %-5p %c{4} %M.%L %x - %m%n" />
      --> 
      <!-- EO-Layout -->
      <param name="ConversionPattern" value="%d %p - %c{4} - %m%n" />
    </layout>
  </appender>

  <!-- 
  A different appender for 'page' logging. This is writing to stdout now too, but probably you want 
  this to go to another file.
  -->     
  <appender name="pagefile" class="org.apache.log4j.FileAppender" >
    <param name="File" value="&logdir;page.log" />
    <param name="Append" value="true" />
    <layout class="org.apache.log4j.PatternLayout">
      <param name="ConversionPattern" value="%d{MM-dd HH:mm:ss} PAGE %-7p %c{2} %L - %m%n" />
    </layout>
  </appender>

  <appender name="sqlfile" class="org.apache.log4j.FileAppender" >
    <param name="File"   value="&logdir;sqllog4j.log" />
    <param name="Append" value="true" />
    <layout class="org.apache.log4j.PatternLayout">
         <param name="ConversionPattern" value="%d %p - %c{4} - %m%n" />
    </layout>
  </appender>

  <appender name="vwmfile" class="org.apache.log4j.FileAppender" >
    <param name="File"   value="&logdir;vwmlog4j.log" />
    <param name="Append" value="true" />
    <layout class="org.apache.log4j.PatternLayout">
         <param name="ConversionPattern" value="%d %p - %c{4} - %m%n" />
    </layout>
  </appender>

  <appender name="copfile" class="org.apache.log4j.FileAppender" >
    <param name="File"   value="&logdir;coplog4j.log" />
    <param name="Append" value="true" />
    <layout class="org.apache.log4j.PatternLayout">
         <param name="ConversionPattern" value="%d %p - %c{4} - %m%n" />
    </layout>
  </appender>

  
  <!-- categories -->
  
  <!-- examples: different level for a few subtrees -->
  <logger name="org.mmbase.bridge" >
    <level class="&mmlevel;" value ="warn" />
  </logger>

  <logger name="org.mmbase.security" >
    <level class="&mmlevel;" value ="warn" />
  </logger>


  <!-- 'page logging' goes to a different appender -->
  <logger name="org.mmbase.PAGE" additivity="false">
    <level class="&mmlevel;" value ="warn" />
    <appender-ref ref="pagefile" />
  </logger>

  <!-- 'database logging' goes to a different appender -->
  <logger name="org.mmbase.module.database" additivity="false">
    <level class="&mmlevel;" value ="warn" />
    <appender-ref ref="sqlfile" />
  </logger>

  <!-- 'vwm logging' goes to a different appender -->
  <logger name="nl.eo.mmbase.module.builders.vwms" additivity="false">
    <level class="&mmlevel;" value ="warn" />
    <appender-ref ref="vwmfile" />
  </logger>

  <!-- 'vwm logging' goes to a different appender -->
  <logger name="org.mmbase.module.builders.vwms" additivity="false">
    <level class="&mmlevel;" value ="warn" />
    <appender-ref ref="vwmfile" />
  </logger>

  <!-- 'Statuscop logging' goes to a different appender -->
  <logger name="nl.eo.mmbase.module.builders.vwms.StatusCop" additivity="false">
    <level class="&mmlevel;" value ="warn" />
    <appender-ref ref="copfile" />
  </logger>

  <!-- 'MMBase core logging' goes to a different appender -->
  <logger name="org.mmbase.module.core.MMBase" additivity="false">
    <level class="&mmlevel;" value ="info" />
    <appender-ref ref="logfile" />
  </logger>

  <!-- 
  STDERR is a special Category, to wich stderr will be written
  (always with level 'warn' or higher)  
  The level can be set to 'fatal' and the stderr will not be
  redirected to mmbase logging.
  -->
 
  <logger name="STDERR">
    <level class="&mmlevel;" value ="info" />	
  </logger>
  
  <root>
    <level class="&mmlevel;" value ="warn" />
    <appender-ref ref="logfile" />
  </root>

</log4j:configuration>
