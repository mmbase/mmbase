<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>Install MMBase-war on Tomcat 4.x</title>
    
</head>
  <body>
                   
<h3>CAUTION THIS IS STILL IN DEVELOPMENT, AND NOT A STABLE SOMETHING</h3>
<h5>Version $Id: tomcat-4.x.html,v 1.3 2002-06-11 14:59:49 eduard Exp $</h5>
<p> ( in this document current dir is the tomcat directory, all files that 
    are added/modified should be readable by user that  runs tomcat, directories 
    that are created, should have all rights for the user that runs tomcat) 
  </p>
                    
<ul>
              <li>Install Tomcat</li>
              <li>Make sure the jsp-examples work</li>
              <li>Activate the Application Manager by changing the file conf/tomcat-users.xml 
    from:    <br>
                                   
    <pre>        <span class="comment">&lt;!--<br>          NOTE:  By default, no user is included in the "manager" role required<br>          to operate the "/manager" web application.  If you wish to use this app,<br>          you must define such a user - the username and password are arbitrary.<br>        --&gt;</span><br>        &lt;<span
 class="start-tag">tomcat-users</span>&gt;<br>          &lt;<span
 class="start-tag">user</span><span class="attribute-name"> name</span>=<span
 class="attribute-value">"tomcat" </span><span class="attribute-name">password</span>=<span
 class="attribute-value">"tomcat" </span><span class="attribute-name">roles</span>=<span
 class="attribute-value">"tomcat" </span><span class="attribute-name">/</span>&gt;<br>          &lt;<span
 class="start-tag">user</span><span class="attribute-name"> name</span>=<span
 class="attribute-value">"role1"  </span><span class="attribute-name">password</span>=<span
 class="attribute-value">"tomcat" </span><span class="attribute-name">roles</span>=<span
 class="attribute-value">"role1"  </span><span class="attribute-name">/</span>&gt;<br>          &lt;<span
 class="start-tag">user</span><span class="attribute-name"> name</span>=<span
 class="attribute-value">"both"   </span><span class="attribute-name">password</span>=<span
 class="attribute-value">"tomcat" </span><span class="attribute-name">roles</span>=<span
 class="attribute-value">"tomcat,role1" </span><span
 class="attribute-name">/</span>&gt;<br>        &lt;/<span
 class="end-tag">tomcat-users</span>&gt;</pre>
                  Into something like(notice that secret should be replaced 
 by  your  password)                                                    
    <pre>        &lt;<span class="start-tag">tomcat-users</span>&gt;<br>          &lt;<span
 class="start-tag">user</span><span class="attribute-name"> name</span>=<span
 class="attribute-value">"manager" </span><span class="attribute-name">password</span>=<span
 class="attribute-value">"secret" </span><span class="attribute-name">roles</span>=<span
 class="attribute-value">"manager" </span><span class="attribute-name">/</span>&gt;<br>        &lt;/<span
 class="end-tag">tomcat-users</span>&gt;<span class="end-tag"></span></pre>
              </li>
              <li>Make the directory temp (only needed for tomcat 4.0.2/3)</li>
        <li>Turn unpacking of war's on inside the conf/server.xml by changing: 
                          
    <pre>&lt;Host name="localhost" debug="0" appBase="webapps" unpackWARs="false"&gt;<br></pre>
      into:                         
    <pre>&lt;Host name="localhost" debug="0" appBase="webapps" unpackWARs="true"&gt;</pre>
       </li>
       <li>When a security manager is used, make sure that you grant the
rights   for certain things(in file conf/catalina.policy):              
      
    <pre>grant { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; permission java.util.PropertyPermission "user.dir", "read"; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; permission java.util.PropertyPermission "mmbase.*", "read"; <br>}; <br></pre>
     Or if you want to grant everything to the security manager(not very
wise!)                      
    <pre>grant&nbsp; { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; permission java.security.AllPermission; <br>}; <br></pre>
     </li>
              <li>Restart the server, to activate the changes, which were 
made   (nessecary?)</li>
              <li>Install the latest mmbase.war by visiting the following 
url   (use   the name/password combination which was used inside the conf/tomcat-users.xml): 
             http://localhost:8080/manager/install?path=/mmbase&amp;war=jar:http://www.mmbase.org/download/builds/last/mmbase.war!/
     	(http://localhost:8080/manager/install?path=/mmbase&amp;war=jar:http://www.mmbase.org:8070/testing/common/lastbuild/mmbase.war!/ 
    to retrieve it from a running instance of the nightly build itselve) 
       <br>
                      Or when you placed it somewhere else:         http://localhost:8080/manager/install?path=/mmbase&amp;war=jar:file:///home/eduard/mmbase/build/mmbase/mmbase.war!/
         <br>
                      More info at: http://localhost:8080/tomcat-docs/manager-howto.html
         </li>
              <li>Copy the file webapps/mmbase/WEB-INF/lib/xml-apis.jar to
 the   directory  common/lib/</li>
              <li>Restart the server, to activate the changes, which were 
made   (nessecary?)</li>
              <li>Visit http://localhost:8080/mmbase/</li>
   
</ul>
   
<p> When the taglibs aint working.. you can try to do the following things(on
 shell):       </p>
 
<pre># jar xf lib/mmbase.jar META-INF/taglib.tld <br># mv META-INF/taglib.tld . <br># rmdir META-INF<br></pre>
   and add the following lines to the file webapps/mmbase/WEB-INF/web.xml
      
<pre>  &lt;taglib&gt; <br>    &lt;taglib-uri&gt;http://www.mmbase.org/mmbase-taglib-1.0&lt;/taglib-uri&gt; <br>    &lt;taglib-location&gt;/mmbase/WEB-INF/taglib.tld&lt;/taglib-location&gt; <br>  &lt;/taglib&gt;<br></pre>
        
</body>
</html>
