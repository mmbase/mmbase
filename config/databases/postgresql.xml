<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE database PUBLIC "-//MMBase//DTD database config 1.2//EN" "http://www.mmbase.org/dtd/database_1_2.dtd" 
[
  <!ENTITY extra  SYSTEM "postgresql_extra.xml">
]
>
<database>
  <name>PostgreSQL</name>
  <mmbasedriver>org.mmbase.storage.database.PostgreSqlStorage</mmbasedriver>
  <sqlhandler>org.mmbase.storage.search.implementation.database.PostgreSqlSqlHandler</sqlhandler>
  <chainedsqlhandler></chainedsqlhandler>
	<!-- BLOB support is terrible to maintain for Postgresql.
       I suggest that we use blobdatadir.
	     Use something like this.
  <blobdatadir>../../data</blobdatadir>
       -->
  <scheme>
    <create>CREATE TABLE {0} ({1})</create>
    <create-extended>CREATE TABLE {0} ({1}) INHERITS ({2})</create-extended>
    <not-null>{0} {1} NOT NULL</not-null>
    <primary-key>{0} {1} NOT NULL, PRIMARY KEY ({0})</primary-key>
    <!-- 
       Foreign keys do not work on postgresql (at least not on inherited tables

       This would be logical:
       <foreign-key>{0} {1} NULL, FOREIGN KEY ({0}) REFERENCES {2} (number)</foreign-key>

       But we have to do this because of silly limitations in postgresql:
    -->
    <foreign-key>{0} {1} NULL</foreign-key> <!-- node field must accept null during import -->
    <key>{0} {1} NOT NULL, UNIQUE ({0})</key>
  </scheme>
  <mapping>
    <type-mapping mmbase-type="FLOAT">REAL</type-mapping>
    <type-mapping mmbase-type="DOUBLE">DOUBLE PRECISION</type-mapping>
    <type-mapping mmbase-type="LONG">BIGINT</type-mapping>
    <type-mapping mmbase-type="INTEGER">INTEGER</type-mapping>
    <type-mapping mmbase-type="NODE">INTEGER</type-mapping>
    <type-mapping mmbase-type="STRING">TEXT</type-mapping>
    <type-mapping mmbase-type="XML">TEXT</type-mapping>
    <!--type-mapping mmbase-type="BYTE">OID</type-mapping--> 
    <!-- This works with postgresql 7.3.2 (driver 1.7.1). bytea didn't -->
    <type-mapping mmbase-type="BYTE">bytea</type-mapping>
  </mapping>
  &extra;
</database>
