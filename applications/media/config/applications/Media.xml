<!DOCTYPE application PUBLIC "//MMBase - application//" "http://www.mmbase.org/dtd/application_1_0.dtd">
<application name="Media" maintainer="mediaproject.mmbase.org" version="1" auto-deploy="true">
  <neededbuilderlist>
    <builder maintainer="mediaproject.mmbase.org" version="1">mediafragments</builder>
    <builder maintainer="mediaproject.mmbase.org" version="1">audiofragments</builder>
    <builder maintainer="mediaproject.mmbase.org" version="1">videofragments</builder>

    <builder maintainer="mediaproject.mmbase.org" version="1">mediasources</builder>
    <builder maintainer="mediaproject.mmbase.org" version="1">audiosources</builder>
    <builder maintainer="mediaproject.mmbase.org" version="1">videosources</builder>

    <builder maintainer="mediaproject.mmbase.org" version="1">mediaproviders</builder>

    <builder maintainer="mediaproject.mmbase.org" version="1">templates</builder>

    <builder maintainer="mediaproject.mmbase.org" version="1">insrel</builder>
    <builder maintainer="mediaproject.mmbase.org" version="1">posrel</builder>

    <builder maintainer="mediaproject.mmbase.org" version="1">pools</builder>
    <builder maintainer="mediaproject.mmbase.org" version="1">publishtimes</builder>

  </neededbuilderlist>

  <neededreldeflist>
    <reldef source="related" target="related" direction="bidirectional" guisourcename="Related" guitargetname="Related" builder="insrel" />
    <reldef source="parent"  target="parent"  direction="bidirectional" guisourcename="Parent"  guitargetname="Child" builder="insrel" />
    <reldef source="previous" target="previous"    direction="bidirectional" guisourcename="Next"  guitargetname="Previous" builder="insrel" /><!-- relation is a little strange, but this is because of editwizard limitation -->
    <reldef source="posrel"  target="posrel"  direction="bidirectional" guisourcename="Posrel"  guitargetname="Posrel" builder="posrel" />
  </neededreldeflist>

  <allowedrelationlist>

    <!-- these relations are the core of the Media project -->

    <!-- should be 
    <relation from="videofragments"  to="videosources"    type="related" />
    <relation from="audiofragments"  to="audiosources"    type="related" />
      -->
    
    <relation from="mediafragments"  to="mediasources"    type="related" /> <!-- to make getRelatedNodes('mediasources') possible .. -->
 
    <relation from="mediasources"    to="mediaproviders"  type="related" />


    <!-- The fragment related to the sources is special and is linked with 'parent' to the other fragments -->
    <!-- should be 
    <relation from="videofragments"  to="videofragments"  type="parent" />
    <relation from="audiofragments"  to="audiofragments"  type="parent" />
     -->
    <relation from="mediafragments"  to="mediafragments"  type="parent" /> <!-- to make getRelatedNodes('mediafragments') possible .. -->

    <!-- subfragments -->
    <relation from="videofragments"  to="videofragments"  type="posrel" />
    <relation from="audiofragments"  to="audiofragments"  type="posrel" />

    
    <!-- it is possible to associated 'templates' (probably jsp) to a certain fragment -->
    <relation from="mediafragments"  to="templates"    type="related" />
    
    <!-- more specific stuff follows -->

    <!-- a subfragment can be e.g. nog valid by linking to a 'publishtimes' object -->
    <relation from="mediafragments"  to="publishtimes"    type="related" />

    <!-- for introduction -->
    <relation from="mediafragments"  to="mediafragments"  type="previous" /> 

    <!-- grouping / categorizing -->
    <relation from="pools"           to="pools"           type="parent"  />  
    <relation from="pools"           to="mediafragments"  type="related" />
   
  </allowedrelationlist>

  <datasourcelist>
		<datasource builder="mediafragments"   path="Media/mediafragments.xml" />
		<datasource builder="audiofragments"   path="Media/audiofragments.xml" />
		<datasource builder="videofragments"   path="Media/videofragments.xml" />

		<datasource builder="mediasources"     path="Media/mediasources.xml" />
		<datasource builder="audiosources"     path="Media/audiosources.xml" />
		<datasource builder="videosources"     path="Media/videosources.xml" />

		<datasource builder="mediaproviders"     path="Media/mediaproviders.xml" />

		<datasource builder="templates"          path="Media/templates.xml" />

		<datasource builder="pools"            path="Media/pools.xml" />
	</datasourcelist>

	<relationsourcelist>
		<relationsource builder="insrel" path="Media/insrel.xml" />
		<relationsource builder="posrel" path="Media/posrel.xml" />
  </relationsourcelist>
  
  <contextsourcelist>
    <contextsource path="Media/backup.xml" type="depth" goal="backup"/>
  </contextsourcelist>

  <description>
     Relations needed for the media-project + some examples 
  </description>

  <install-notice>
     The needed relations for the media functionality are created. And some examples are inserted.
  </install-notice>
</application>
