<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:jsp="http://java.sun.com/JSP/Page"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:mm-u="urn:jsptagdir:/WEB-INF/tags/mm/u"
      xmlns:mm="http://www.mmbase.org/mmbase-taglib-2.0"
    lang="en">
  <jsp:directive.page buffer="10000kb" />

  <mm:content type="application/xhtml+xml"
              postprocessor="none"
              language="nl" expires="0">
    <mm:cloud rank="basic user">
      <mm:param name="org.mmbase.xml-mode" value="wiki" />


      <head>
        <mm:import id="jq"><mm:url page="/mmbase/jquery/" /></mm:import>

        <script src="${jq}jquery-1.2.3.min.js"><jsp:text> </jsp:text></script>
        <script src="${jq}jquery.dimensions.js"><jsp:text> </jsp:text></script>
        <script src="${jq}ui.mouse.js"></script>

        <script src="${jq}ui.resizable.js"></script>
        <!--
        <script type="text/javascript" src="${jq}ui.accordion.js"> </script>
        -->
        <jsp:directive.include file="/mmbase/validation/javascript.jspxf" />
        <script language="javascript" src="edit.js"><jsp:text> </jsp:text></script>
        <link rel="stylesheet" type="text/css" href="q.css" />
      </head>
      <body>

        <mm:haspage page="/mmbase/jquery/jquery-1.2.3.min.js" inverse="true">
          <h1 class="error">You need to have jquery installed in /mmbase/jquery!</h1>
        </mm:haspage>
        <mm:import externid="objectnumber" />
        <mm:compare referid="objectnumber" value="new">
          <mm:remove referid="objectnumber" />
          <mm:createnode type="wikiobjects" id="objectnumber"  />

        </mm:compare>

        <div id="main">
          <mm:form id="transaction" page=".">
            <mm:node referid="objectnumber" commitonclose="false">

              <input type="hidden" name="objectnumber" value="${_node}" />
              <table>
                <mm:fieldlist type="edit">
                  <tr>
                    <td>
                      <mm:fieldinfo type="guiname" />
                    </td>
                    <td>
                      <mm:fieldinfo type="input" />
                      <mm:fieldinfo type="errors" />
                    </td>
                  </tr>
                </mm:fieldlist>
              </table>
              <input type="submit" name="submit" id="submit" />
              <hr />
              <mm:link page=".." referids="_node@objectnumber">
                <mm:param name="expires">0</mm:param>
                <a href="${_}">back</a>
              </mm:link>
              <jsp:text> | </jsp:text>
              <mm:link page="../versions" referids="_node@objectnumber">
                <mm:param name="expires">0</mm:param>
                <a href="${_}">versions</a>
              </mm:link>
            </mm:node>
          </mm:form>
        </div>
        <div id="relations">
          <mm:node referid="objectnumber" commitonclose="false">

            <mm:form id="transaction">
              <ul>
                <c:forTokens items="urls,images" delims="," var="type" >
                  <mm:include page="related.li.jspx" referids="type" />
                </c:forTokens>
              </ul>
            </mm:form>
          </mm:node>
          </div>
          <div id="commit">
            <mm:form id="transaction">
              <mm:valid>
                <mm:import externid="submit" />
                <mm:present referid="submit">
                  <h1>Committing ${_} for ${transaction.cloudVar}</h1>
                  <mm:commit />
                </mm:present>
              </mm:valid>
            </mm:form>
          </div>
          <div id="title">
            <mm:node referid="objectnumber">
              <mm:field name="number" />: <mm:nodeinfo type="gui" /> : v ${_node.version}
            </mm:node>
          </div>
      </body>
    </mm:cloud>

  </mm:content>
</html>
